import{j as c}from"./jsx-runtime-ccada58e.js";import{a as S,r as o}from"./index-f1f749bf.js";import{u as B,g as J,h as T,i as $,s as z}from"./api-8cbaaf7f.js";import{B as F}from"./button-e6a9a480.js";import{H as G}from"./header-2af99fd6.js";import{I as L}from"./input-546805be.js";import"./_commonjsHelpers-042e6b4d.js";import"./index-67faaf7e.js";import"./extends-98964cd2.js";const V=()=>B();/**
 * @remix-run/router v1.5.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},w.apply(this,arguments)}var O;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(O||(O={}));function h(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function b(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let a=e.indexOf("?");a>=0&&(t.search=e.substr(a),e=e.substr(0,a)),e&&(t.pathname=e)}return t}var P;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(P||(P={}));function K(e,t){t===void 0&&(t="/");let{pathname:r,search:a="",hash:n=""}=typeof e=="string"?b(e):e;return{pathname:r?r.startsWith("/")?r:Q(r,t):t,search:Z(a),hash:k(n)}}function Q(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function y(e,t,r,a){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function X(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function q(e,t,r,a){a===void 0&&(a=!1);let n;typeof e=="string"?n=b(e):(n=w({},e),h(!n.pathname||!n.pathname.includes("?"),y("?","pathname","search",n)),h(!n.pathname||!n.pathname.includes("#"),y("#","pathname","hash",n)),h(!n.search||!n.search.includes("#"),y("#","search","hash",n)));let i=e===""||n.pathname==="",s=i?"/":n.pathname,l;if(a||s==null)l=r;else{let m=t.length-1;if(s.startsWith("..")){let g=s.split("/");for(;g[0]==="..";)g.shift(),m-=1;n.pathname=g.join("/")}l=m>=0?t[m]:"/"}let u=K(n,l),f=s&&s!=="/"&&s.endsWith("/"),v=(i||s===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(f||v)&&(u.pathname+="/"),u}const Y=e=>e.join("/").replace(/\/\/+/g,"/"),Z=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,k=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;/**
 * React Router v6.10.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function H(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}const A=typeof Object.is=="function"?Object.is:H,{useState:ee,useEffect:te,useLayoutEffect:ne,useDebugValue:re}=S;function ae(e,t,r){const a=t(),[{inst:n},i]=ee({inst:{value:a,getSnapshot:t}});return ne(()=>{n.value=a,n.getSnapshot=t,E(n)&&i({inst:n})},[e,a,t]),te(()=>(E(n)&&i({inst:n}),e(()=>{E(n)&&i({inst:n})})),[e]),re(a),a}function E(e){const t=e.getSnapshot,r=e.value;try{const a=t();return!A(r,a)}catch{return!0}}function se(e,t,r){return t()}const oe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ie=!oe,le=ie?se:ae;"useSyncExternalStore"in S&&(e=>e.useSyncExternalStore)(S);const ue=o.createContext(null),ce=o.createContext(null),R=o.createContext(null),fe=o.createContext({outlet:null,matches:[]});function C(){return o.useContext(R)!=null}function de(){return C()||h(!1),o.useContext(R).location}function pe(){C()||h(!1);let{basename:e,navigator:t}=o.useContext(ce),{matches:r}=o.useContext(fe),{pathname:a}=de(),n=JSON.stringify(X(r).map(l=>l.pathnameBase)),i=o.useRef(!1);return o.useEffect(()=>{i.current=!0}),o.useCallback(function(l,u){if(u===void 0&&(u={}),!i.current)return;if(typeof l=="number"){t.go(l);return}let f=q(l,JSON.parse(n),a,u.relative==="path");e!=="/"&&(f.pathname=f.pathname==="/"?e:Y([e,f.pathname])),(u.replace?t.replace:t.push)(f,u.state,u)},[e,t,n,a])}var j;(function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator"})(j||(j={}));var N;(function(e){e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator"})(N||(N={}));function he(e){let{to:t,replace:r,state:a,relative:n}=e;C()||h(!1);let i=o.useContext(ue),s=pe();return o.useEffect(()=>{i&&i.navigation.state!=="idle"||s(t,{replace:r,state:a,relative:n})}),null}var U;(function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"})(U||(U={}));new Promise(()=>{});function D(){const[e,{isLoading:t,isSuccess:r,error:a}]=J(),[n]=T(),[i]=$(),[s,l]=o.useState(a),[u,f]=o.useState(""),[v,m]=o.useState(""),g=V();if(r)return c.jsx(he,{to:"/"});const _=async()=>{g(z(`https://${u.split(":")[1]}`));const{isError:d,error:M}=await n(void 0);if(d){l(M);return}const{data:W}=await i(void 0,!0);if((W?.flows?.filter(p=>p.type==="m.login.password")?.length||0)>0){const p=await e({type:"m.login.password",identifier:{type:"m.id.user",user:u},user:u,password:v});if("error"in p){if(JSON.stringify(p.error).includes("M_LIMIT_EXCEEDED")){l({status:"CUSTOM_ERROR",error:"Too many attempts, try again later"});return}if(JSON.stringify(p.error).includes("M_FORBIDDEN")){l({status:"CUSTOM_ERROR",error:p.error.data.error});return}l(p.error);return}}else l({status:"CUSTOM_ERROR",error:"No password login flow found"})};return c.jsxs("form",{className:"flex flex-col rounded-md shadow p-4 bg-white gap-2 min-w-[30rem]",onSubmit:d=>{d.preventDefault(),_()},children:[c.jsx(G,{children:"Login"}),s?c.jsx("h2",{className:"text-red-500 font-normal text-sm",children:"error"in s?s.error:"data"in s?JSON.stringify(s.data):s.message}):c.jsx("div",{className:"min-h-[1.25rem]"}),c.jsx(L,{readonly:t,value:u,placeholder:"Username",onChange:d=>f(d.target.value)}),c.jsx(L,{readonly:t,value:v,password:!0,placeholder:"Password",onChange:d=>m(d.target.value)}),c.jsx(F,{readonly:t,style:"primary",type:"submit",children:"Login"})]})}D.__docgenInfo={description:"",methods:[],displayName:"Login"};function I(){return c.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-img",children:c.jsx(D,{})})}I.__docgenInfo={description:"",methods:[],displayName:"LoginPage"};const Le={title:"Pages/LoginPage",tags:["autodocs"],component:I},x={};x.parameters={...x.parameters,docs:{...x.parameters?.docs,source:{originalSource:"{}",...x.parameters?.docs?.source}}};const Oe=["Default"];export{x as Default,Oe as __namedExportsOrder,Le as default};
//# sourceMappingURL=LoginPage.stories-7eb25179.js.map
