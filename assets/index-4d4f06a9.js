import{c as Ce,r as Le,a as we,b as U,f as ye,d as ve,p as ke,e as Ee,g as Re,h as Se,F as _e,R as Oe,P as Me,i as Ae,j as Te,k as Ie,u as De,l as Pe,m as l,n as e,N as Z,L as $e,o as J,q as d,s as E,t as $,v as _,w as R,x as k,y as b,U as ze,z as Fe,H as Y,A as ee,B as He,C as Ue,D as Be,E as z,T as te,G as se,I as ae,Q as oe,J as ne,K as q,M as Ke,O as Qe,S as qe,V as Ge,W as We,X as Ve,Y as Xe,Z as Ze,_ as Je,$ as Ye,a0 as et,a1 as tt,a2 as st,a3 as at,a4 as P,a5 as ot,a6 as nt,a7 as rt,a8 as it,a9 as lt,aa as ct,ab as dt,ac as ut,ad as G,ae as mt,af as gt,ag as ht,ah as ft}from"./vendor-f66b2b34.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const T=U("auth/host"),re=U("auth/access_token"),M=U("auth/logged_in"),xt={logged_in:!1},pt=Ce(xt,t=>t.addCase(T,(s,n)=>{s.host=n.payload}).addCase(re,(s,n)=>{s.accessToken=n.payload}).addCase(M,(s,n)=>{s.logged_in=n.payload})),Nt=async(t,s,n)=>{const a=s.getState().auth.host;return a?bt(a)(t,s,n):{error:{status:400,statusText:"Bad Request",data:"Invalid Matrix Host"}}},jt=Le(async(t,s,n)=>{const a=await Nt(t,s,n);if(a.error?.status===429){const o=a.error.data.retry_after_ms;o&&await new Promise(r=>setTimeout(r,o))}return a},{maxRetries:3}),I=we({reducerPath:"matrixApi",baseQuery:jt,tagTypes:["Login","Flows","WellKnown"],endpoints:t=>({getWellKnown:t.query({query:()=>"/.well-known/matrix/client",providesTags:["WellKnown"],async onQueryStarted(s,{dispatch:n,queryFulfilled:a}){try{const{data:o,meta:r}=await a;r.response.status===200&&o?.["m.homeserver"]?.base_url&&n(T(o["m.homeserver"].base_url))}catch{}}}),getLoginFlows:t.query({query:()=>"/_matrix/client/v3/login",providesTags:["Flows"]}),doLogin:t.mutation({query:s=>({url:"/_matrix/client/r0/login",method:"POST",body:s}),async onQueryStarted(s,{dispatch:n,queryFulfilled:a}){try{const{data:o,meta:r}=await a;r.response.status===200?(n(M(!0)),n(re(o.access_token)),o.well_known?.["m.homeserver"]?.base_url&&n(T(o.well_known["m.homeserver"].base_url))):n(M(!1))}catch{n(M(!1))}},invalidatesTags:["Login"]})})}),bt=t=>ye({baseUrl:t,prepareHeaders:(s,{getState:n})=>{const a=n().auth.accessToken;return a&&s.set("Authorization",`Bearer ${a}`),s}}),{useLazyGetLoginFlowsQuery:Ct,useDoLoginMutation:Lt,useLazyGetWellKnownQuery:wt}=I,yt={key:"root",version:1,storage:ve({name:"cetirizine",storeName:"cetirizine"}),serialize:!1,deserialize:!1},vt=ke(yt,{auth:pt,[I.reducerPath]:I.reducer}),B=Ee({reducer:vt,middleware:t=>[...t({serializableCheck:{ignoredActions:[_e,Oe,Me,Ae,Te,Ie]}}),I.middleware]});Re.setupListeners(B.dispatch);const kt=Se(B);const Et=()=>Pe(),Rt=De;const St=({type:t="button",style:s="primary",onClick:n,children:a,readonly:o})=>s==="secondary"?e.jsx("button",{disabled:o,onClick:n,className:"button bg-orange-400 hover:bg-orange-500 ease-out duration-150 disabled:bg-slate-200 disabled:cursor-not-allowed",type:t,children:a}):s==="abort"?e.jsx("button",{disabled:o,onClick:n,className:"button bg-red-400 hover:bg-red-500 ease-out duration-150 disabled:bg-slate-200 disabled:cursor-not-allowed",type:t,children:a}):e.jsx("button",{disabled:o,onClick:n,className:"button bg-green-400 hover:bg-green-500 ease-out duration-150 disabled:bg-slate-200 disabled:cursor-not-allowed",type:t,children:a}),_t=l.memo(St),Ot=({children:t})=>e.jsx("h1",{className:"text-black font-bold text-xl",children:t}),Mt=({placeholder:t,password:s=!1,autoFocus:n=!1,value:a,readonly:o,onChange:r})=>e.jsx("input",{disabled:o,className:"form-input rounded-lg disabled:bg-slate-200 disabled:cursor-not-allowed transition-colors ease-in-out delay-150",value:a,type:s?"password":"text",autoFocus:n,placeholder:t,onChange:r}),W=l.memo(Mt);function At(){const[t,{isLoading:s,isSuccess:n,error:a}]=Lt(),[o]=wt(),[r]=Ct(),[i,g]=l.useState(a),[f,C]=l.useState(""),[N,L]=l.useState(""),c=Et();if(n)return e.jsx(Z,{to:"/"});const x=async()=>{c(T(`https://${f.split(":")[1]}`));const{isError:u,error:j}=await o(void 0);if(u){g(j);return}const{data:p}=await r(void 0,!0);if((p?.flows?.filter(h=>h.type==="m.login.password")?.length||0)>0){const h=await t({type:"m.login.password",identifier:{type:"m.id.user",user:f},user:f,password:N});if("error"in h){if(JSON.stringify(h.error).includes("M_LIMIT_EXCEEDED")){g({status:"CUSTOM_ERROR",error:"Too many attempts, try again later"});return}if(JSON.stringify(h.error).includes("M_FORBIDDEN")){g({status:"CUSTOM_ERROR",error:h.error.data.error});return}g(h.error);return}}else g({status:"CUSTOM_ERROR",error:"No password login flow found"})};return e.jsxs("form",{className:"flex flex-col rounded-md shadow p-4 bg-white gap-2 min-w-[30rem]",onSubmit:u=>{u.preventDefault(),x()},children:[e.jsx(Ot,{children:"Login"}),i?e.jsx("h2",{className:"text-red-500 font-normal text-sm",children:"error"in i?i.error:"data"in i?JSON.stringify(i.data):i.message}):e.jsx("div",{className:"min-h-[1.25rem]"}),e.jsx(W,{readonly:s,value:f,placeholder:"Username",onChange:u=>C(u.target.value)}),e.jsx(W,{readonly:s,value:N,password:!0,placeholder:"Password",onChange:u=>L(u.target.value)}),e.jsx(_t,{readonly:s,style:"primary",type:"submit",children:"Login"})]})}function Tt(){return e.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-img",children:e.jsx(At,{})})}const F=({avatarUrl:t,displayname:s,dm:n=!1,online:a=!1})=>t?e.jsxs("div",{className:"flex relative min-w-[2rem] min-h-[2rem] justify-center items-center m-0 mr-3 text-xl rounded-full text-white",children:[e.jsx("img",{className:"rounded-full w-8 h-8",alt:s,src:t}),n?a?e.jsx("div",{className:"bg-green-500 rounded-full w-3 h-3 absolute bottom-0 right-0"}):e.jsx("div",{className:"bg-red-500 rounded-full w-3 h-3 absolute bottom-0 right-0"}):e.jsx(e.Fragment,{})]}):e.jsxs("div",{className:"flex relative min-w-[2rem] min-h-[2rem] bg-orange-500 justify-center items-center m-0 mr-3 text-xl rounded-full text-white",children:[s[0].toUpperCase(),n?a?e.jsx("div",{className:"bg-green-500 rounded-full w-3 h-3 absolute bottom-0 right-0"}):e.jsx("div",{className:"bg-red-500 rounded-full w-3 h-3 absolute bottom-0 right-0"}):e.jsx(e.Fragment,{})]}),It=/((https?:\/\/(www\.)?)|(www\.))[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/,Dt=/(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/,Pt=[t=>{const s=It.exec(t);return s&&{index:s.index,length:s[0].length,text:s[0],url:s[0]}},t=>{const s=Dt.exec(t);return s&&{index:s.index,length:s[0].length,text:s[0],url:`mailto:${s[0]}`}}];function $t(){return e.jsx($e.AutoLinkPlugin,{matchers:Pt})}const A=1,zt=new Set(["paragraph","quote","code","h1","h2","ul","ol"]),Ft={code:"Code Block",h1:"Large Heading",h2:"Small Heading",h3:"Heading",h4:"Heading",h5:"Heading",ol:"Numbered List",paragraph:"Normal",quote:"Quote",ul:"Bulleted List"};function V(){return e.jsx("div",{className:"divider"})}function X(t,s){s?(t.style.opacity="1",t.style.top=`${s.top+s.height+window.pageYOffset+10}px`,t.style.left=`${s.left+window.pageXOffset-t.offsetWidth/2+s.width/2}px`):(t.style.opacity="0",t.style.top="-1000px",t.style.left="-1000px")}function Ht({editor:t}){const s=l.useRef(null),n=l.useRef(null),a=l.useRef(!1),[o,r]=l.useState(""),[i,g]=l.useState(!1),[f,C]=l.useState(null),N=l.useCallback(()=>{const c=d.$getSelection();if(d.$isRangeSelection(c)){const h=ie(c),w=h.getParent();b.$isLinkNode(w)?r(w.getURL()):b.$isLinkNode(h)?r(h.getURL()):r("")}const x=s.current,u=window.getSelection(),j=document.activeElement;if(x===null)return;const p=t.getRootElement();if(c!==null&&!u?.isCollapsed&&p!==null&&p.contains(u?.anchorNode)){const h=u?.getRangeAt(0);let w;if(u?.anchorNode===p){let S=p;for(;S.firstElementChild!=null;)S=S.firstElementChild;w=S.getBoundingClientRect()}else w=h?.getBoundingClientRect();a.current||X(x,w),C(c)}else(!j||j.className!=="link-input")&&(X(x,void 0),C(null),g(!1),r(""));return!0},[t]);l.useEffect(()=>$.mergeRegister(t.registerUpdateListener(({editorState:c})=>{c.read(()=>{N()})}),t.registerCommand(d.SELECTION_CHANGE_COMMAND,()=>(N(),!0),A)),[t,N]),l.useEffect(()=>{t.getEditorState().read(()=>{N()})},[t,N]),l.useEffect(()=>{i&&n.current&&n.current.focus()},[i]);const L=l.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer"},o);return e.jsx("div",{ref:s,className:"link-editor",children:i?e.jsx("input",{ref:n,className:"link-input",value:o,onChange:c=>{r(c.target.value)},onKeyDown:c=>{c.key==="Enter"?(c.preventDefault(),f!==null&&(o!==""&&t.dispatchCommand(b.TOGGLE_LINK_COMMAND,o),g(!1))):c.key==="Escape"&&(c.preventDefault(),g(!1))}}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"link-input",children:[L,e.jsx("div",{className:"link-edit",role:"button",tabIndex:0,onMouseDown:c=>c.preventDefault(),onClick:()=>{g(!0)}})]})})})}function Ut({onChange:t,className:s,options:n,value:a}){return e.jsxs("select",{className:s,onChange:t,value:a,children:[e.jsx("option",{hidden:!0,value:""}),n.map(o=>e.jsx("option",{value:o,children:o},o))]})}function ie(t){const s=t.anchor,n=t.focus,a=t.anchor.getNode(),o=t.focus.getNode();return a===o?a:t.isBackward()?k.$isAtNodeEnd(n)?a:o:k.$isAtNodeEnd(s)?o:a}function Bt({editor:t,blockType:s,toolbarRef:n,setShowBlockOptionsDropDown:a}){const o=l.useRef(null);l.useEffect(()=>{const c=n.current,x=o.current;if(c!==null&&x!==null){const{top:u,left:j}=c.getBoundingClientRect();x.style.top=`${u+40}px`,x.style.left=`${j}px`}},[o,n]),l.useEffect(()=>{const c=o.current,x=n.current;if(c!==null&&x!==null){const u=j=>{const p=j.target;!c.contains(p)&&!x.contains(p)&&a(!1)};return document.addEventListener("click",u),()=>{document.removeEventListener("click",u)}}},[o,a,n]);const r=()=>{s!=="paragraph"&&t.update(()=>{const c=d.$getSelection();d.$isRangeSelection(c)&&k.$wrapNodes(c,()=>d.$createParagraphNode())}),a(!1)},i=()=>{s!=="h1"&&t.update(()=>{const c=d.$getSelection();d.$isRangeSelection(c)&&k.$wrapNodes(c,()=>_.$createHeadingNode("h1"))}),a(!1)},g=()=>{s!=="h2"&&t.update(()=>{const c=d.$getSelection();d.$isRangeSelection(c)&&k.$wrapNodes(c,()=>_.$createHeadingNode("h2"))}),a(!1)},f=()=>{s!=="ul"?t.dispatchCommand(E.INSERT_UNORDERED_LIST_COMMAND,void 0):t.dispatchCommand(E.REMOVE_LIST_COMMAND,void 0),a(!1)},C=()=>{s!=="ol"?t.dispatchCommand(E.INSERT_ORDERED_LIST_COMMAND,void 0):t.dispatchCommand(E.REMOVE_LIST_COMMAND,void 0),a(!1)},N=()=>{s!=="quote"&&t.update(()=>{const c=d.$getSelection();d.$isRangeSelection(c)&&k.$wrapNodes(c,()=>_.$createQuoteNode())}),a(!1)},L=()=>{s!=="code"&&t.update(()=>{const c=d.$getSelection();d.$isRangeSelection(c)&&k.$wrapNodes(c,()=>R.$createCodeNode())}),a(!1)};return e.jsxs("div",{className:"dropdown",ref:o,children:[e.jsxs("button",{className:"item",onClick:r,children:[e.jsx(te,{className:"icon",size:20}),e.jsx("span",{className:"text",children:"Normal"}),s==="paragraph"&&e.jsx("span",{className:"active"})]}),e.jsxs("button",{className:"item",onClick:i,children:[e.jsx(Y,{className:"icon",size:20}),e.jsx("span",{className:"text",children:"Large Heading"}),s==="h1"&&e.jsx("span",{className:"active"})]}),e.jsxs("button",{className:"item",onClick:g,children:[e.jsx(ee,{className:"icon",size:20}),e.jsx("span",{className:"text",children:"Small Heading"}),s==="h2"&&e.jsx("span",{className:"active"})]}),e.jsxs("button",{className:"item",onClick:f,children:[e.jsx(ae,{className:"icon",size:20}),e.jsx("span",{className:"text",children:"Bullet List"}),s==="ul"&&e.jsx("span",{className:"active"})]}),e.jsxs("button",{className:"item",onClick:C,children:[e.jsx(se,{className:"icon",size:20}),e.jsx("span",{className:"text",children:"Numbered List"}),s==="ol"&&e.jsx("span",{className:"active"})]}),e.jsxs("button",{className:"item",onClick:N,children:[e.jsx(oe,{className:"icon",size:20}),e.jsx("span",{className:"text",children:"Quote"}),s==="quote"&&e.jsx("span",{className:"active"})]}),e.jsxs("button",{className:"item",onClick:L,children:[e.jsx(z,{className:"icon",size:20}),e.jsx("span",{className:"text",children:"Code Block"}),s==="code"&&e.jsx("span",{className:"active"})]})]})}function Kt(){const[t]=J.useLexicalComposerContext(),s=l.useRef(null),[n,a]=l.useState(!1),[o,r]=l.useState(!1),[i,g]=l.useState("paragraph"),[f,C]=l.useState(null),[N,L]=l.useState(!1),[c,x]=l.useState(""),[u,j]=l.useState(!1),[p,h]=l.useState(!1),[w,S]=l.useState(!1),[le,ce]=l.useState(!1),[de,ue]=l.useState(!1),[me,ge]=l.useState(!1),[he,fe]=l.useState(!1),D=l.useCallback(()=>{const m=d.$getSelection();if(d.$isRangeSelection(m)){const y=m.anchor.getNode(),v=y.getKey()==="root"?y:y.getTopLevelElementOrThrow(),K=v.getKey();if(t.getElementByKey(K)!==null)if(C(K),E.$isListNode(v)){const O=$.$getNearestNodeOfType(y,E.ListNode),be=O?O.getTag():v.getTag();g(be)}else{const O=_.$isHeadingNode(v)?v.getTag():v.getType();g(O),R.$isCodeNode(v)&&x(v.getLanguage()||R.getDefaultCodeLanguage())}S(m.hasFormat("bold")),ce(m.hasFormat("italic")),ue(m.hasFormat("underline")),ge(m.hasFormat("strikethrough")),fe(m.hasFormat("code")),j(k.$isParentElementRTL(m));const Q=ie(m),je=Q.getParent();b.$isLinkNode(je)||b.$isLinkNode(Q)?h(!0):h(!1)}},[t]);l.useEffect(()=>$.mergeRegister(t.registerUpdateListener(({editorState:m})=>{m.read(()=>{D()})}),t.registerCommand(d.SELECTION_CHANGE_COMMAND,(m,y)=>(D(),!1),A),t.registerCommand(d.CAN_UNDO_COMMAND,m=>(a(m),!1),A),t.registerCommand(d.CAN_REDO_COMMAND,m=>(r(m),!1),A)),[t,D]);const xe=l.useMemo(()=>R.getCodeLanguages(),[]),pe=l.useCallback(m=>{t.update(()=>{if(f!==null){const y=d.$getNodeByKey(f);R.$isCodeNode(y)&&y.setLanguage(m.target.value)}})},[t,f]),Ne=l.useCallback(()=>{p?t.dispatchCommand(b.TOGGLE_LINK_COMMAND,null):t.dispatchCommand(b.TOGGLE_LINK_COMMAND,"https://")},[t,p]);return e.jsxs("div",{className:"toolbar",ref:s,children:[e.jsx("button",{disabled:!n,onClick:()=>{t.dispatchCommand(d.UNDO_COMMAND,void 0)},className:"toolbar-item spaced","aria-label":"Undo",children:e.jsx(ze,{className:"format",size:20})}),e.jsx("button",{disabled:!o,onClick:()=>{t.dispatchCommand(d.REDO_COMMAND,void 0)},className:"toolbar-item","aria-label":"Redo",children:e.jsx(Fe,{className:"format",size:20})}),e.jsx(V,{}),zt.has(i)&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"toolbar-item block-controls",onClick:()=>L(!N),"aria-label":"Formatting Options",children:[i==="h1"?e.jsx(Y,{className:"icon",size:20}):i==="h2"?e.jsx(ee,{className:"icon",size:20}):i==="h3"?e.jsx(He,{className:"icon",size:20}):i==="h4"?e.jsx(Ue,{className:"icon",size:20}):i==="h5"?e.jsx(Be,{className:"icon",size:20}):i==="code"?e.jsx(z,{className:"icon",size:20}):i==="paragraph"?e.jsx(te,{className:"icon",size:20}):i==="ol"?e.jsx(se,{className:"icon",size:20}):i==="ul"?e.jsx(ae,{className:"icon",size:20}):i==="quote"?e.jsx(oe,{className:"icon",size:20}):e.jsx(e.Fragment,{}),e.jsx("span",{className:"text",children:Ft[i]}),e.jsx(ne,{size:20})]}),N&&q.createPortal(e.jsx(Bt,{editor:t,blockType:i,toolbarRef:s,setShowBlockOptionsDropDown:L}),document.body),e.jsx(V,{})]}),i==="code"?e.jsxs(e.Fragment,{children:[e.jsx(Ut,{className:"toolbar-item code-language",onChange:pe,options:xe,value:c}),e.jsx("i",{className:"chevron-down inside"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{t.dispatchCommand(d.FORMAT_TEXT_COMMAND,"bold")},className:"toolbar-item spaced "+(w?"active":""),"aria-label":"Format Bold",children:e.jsx(Ke,{className:"format",size:20})}),e.jsx("button",{onClick:()=>{t.dispatchCommand(d.FORMAT_TEXT_COMMAND,"italic")},className:"toolbar-item spaced "+(le?"active":""),"aria-label":"Format Italics",children:e.jsx(Qe,{className:"format",size:20})}),e.jsx("button",{onClick:()=>{t.dispatchCommand(d.FORMAT_TEXT_COMMAND,"underline")},className:"toolbar-item spaced "+(de?"active":""),"aria-label":"Format Underline",children:e.jsx(qe,{className:"format",size:20})}),e.jsx("button",{onClick:()=>{t.dispatchCommand(d.FORMAT_TEXT_COMMAND,"strikethrough")},className:"toolbar-item spaced "+(me?"active":""),"aria-label":"Format Strikethrough",children:e.jsx(Ge,{className:"format",size:20})}),e.jsx("button",{onClick:()=>{t.dispatchCommand(d.FORMAT_TEXT_COMMAND,"code")},className:"toolbar-item spaced "+(he?"active":""),"aria-label":"Insert Code",children:e.jsx(z,{className:"format",size:20})}),e.jsx("button",{onClick:Ne,className:"toolbar-item spaced "+(p?"active":""),"aria-label":"Insert Link",children:e.jsx(We,{className:"format",size:20})}),p&&q.createPortal(e.jsx(Ht,{editor:t}),document.body)," "]})]})}function Qt(){const[t]=J.useLexicalComposerContext();return l.useEffect(()=>R.registerCodeHighlighting(t),[t]),null}const qt={ltr:"ltr",rtl:"rtl",placeholder:"editor-placeholder",paragraph:"editor-paragraph",quote:"editor-quote",heading:{h1:"editor-heading-h1",h2:"editor-heading-h2",h3:"editor-heading-h3",h4:"editor-heading-h4",h5:"editor-heading-h5"},list:{nested:{listitem:"editor-nested-listitem"},ol:"editor-list-ol",ul:"editor-list-ul",listitem:"editor-listitem"},image:"editor-image",link:"editor-link",text:{bold:"editor-text-bold",italic:"editor-text-italic",overflowed:"editor-text-overflowed",hashtag:"editor-text-hashtag",underline:"editor-text-underline",strikethrough:"editor-text-strikethrough",underlineStrikethrough:"editor-text-underlineStrikethrough",code:"editor-text-code"},code:"editor-code",codeHighlight:{atrule:"editor-tokenAttr",attr:"editor-tokenAttr",boolean:"editor-tokenProperty",builtin:"editor-tokenSelector",cdata:"editor-tokenComment",char:"editor-tokenSelector",class:"editor-tokenFunction","class-name":"editor-tokenFunction",comment:"editor-tokenComment",constant:"editor-tokenProperty",deleted:"editor-tokenProperty",doctype:"editor-tokenComment",entity:"editor-tokenOperator",function:"editor-tokenFunction",important:"editor-tokenVariable",inserted:"editor-tokenSelector",keyword:"editor-tokenAttr",namespace:"editor-tokenVariable",number:"editor-tokenProperty",operator:"editor-tokenOperator",prolog:"editor-tokenComment",property:"editor-tokenProperty",punctuation:"editor-tokenPunctuation",regex:"editor-tokenVariable",selector:"editor-tokenSelector",string:"editor-tokenSelector",symbol:"editor-tokenProperty",tag:"editor-tokenProperty",url:"editor-tokenOperator",variable:"editor-tokenVariable"}};function Gt(){return e.jsx("div",{className:"editor-placeholder",id:"editor-placeholder",children:"Enter message..."})}const Wt=({namespace:t,onChange:s,onError:n})=>{const a={namespace:t,theme:qt,onError:n,nodes:[_.HeadingNode,E.ListNode,E.ListItemNode,_.QuoteNode,R.CodeNode,R.CodeHighlightNode,P.TableNode,P.TableCellNode,P.TableRowNode,b.AutoLinkNode,b.LinkNode]};return e.jsx(Ve.LexicalComposer,{initialConfig:a,children:e.jsxs("div",{className:"editor-container",children:[e.jsx(Kt,{}),e.jsxs("div",{className:"editor-inner",children:[e.jsx(Xe.RichTextPlugin,{contentEditable:e.jsx(Ze.ContentEditable,{className:"editor-input","aria-labelledby":"editor-placeholder"}),placeholder:e.jsx(Gt,{}),ErrorBoundary:Je}),e.jsx(Ye.OnChangePlugin,{onChange:s}),e.jsx(et.HistoryPlugin,{}),e.jsx(tt.LinkPlugin,{}),e.jsx(Qt,{}),e.jsx($t,{}),e.jsx(st.MarkdownShortcutPlugin,{transformers:at.TRANSFORMERS})]})]})})},Vt=({avatarUrl:t,displayname:s,dm:n=!1,online:a=!1,active:o=!1,onClick:r,hidden:i})=>{const{ref:g,inView:f}=ot({triggerOnce:!0,rootMargin:"200px 0px",skip:i});return e.jsx("div",{ref:g,onClick:r,className:"w-full cursor-pointer",children:f&&(o?e.jsxs("div",{className:"flex flex-row gap-2 p-1 bg-gray-300 hover:bg-gray-400 rounded-lg duration-200 ease-in-out items-center",children:[e.jsx(F,{avatarUrl:t,displayname:s,dm:n,online:a}),e.jsx("span",{title:s,className:"text-slate-900 font-normal text-base capitalize max-w-[32ch] overflow-hidden text-ellipsis w-full whitespace-nowrap",children:s})]}):e.jsxs("div",{className:"flex flex-row gap-2 p-1 hover:bg-gray-300 rounded-lg duration-200 ease-in-out items-center",children:[e.jsx(F,{avatarUrl:t,displayname:s,dm:n,online:a}),e.jsx("span",{title:s,className:"text-slate-900 font-normal text-base capitalize max-w-[32ch] overflow-hidden text-ellipsis w-full whitespace-nowrap",children:s})]}))})},Xt=({sectionID:t,rooms:s,onClick:n,activeRoom:a,hidden:o})=>{const r=s.map(i=>e.jsx(Vt,{hidden:o,avatarUrl:i.avatarUrl,displayname:i.displayname,dm:i.dm,online:i.online,active:i.roomID===a,onClick:()=>{n(i.roomID)}},i.roomID+t));return e.jsx(e.Fragment,{children:r})},H=({section:t,onRoomClick:s,activeRoom:n})=>{const[a,o]=l.useState(!1);return e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex flex-row gap-2 py-1  items-center justify-start cursor-pointer h-8 text-slate-600",onClick:()=>o(r=>!r),children:[a?e.jsx(nt,{size:14}):e.jsx(ne,{size:14}),e.jsx("span",{className:"font-normal text-sm capitalize max-w-[32ch] overflow-hidden text-ellipsis w-full whitespace-nowrap",children:t.sectionName})]}),!a&&e.jsx(Xt,{hidden:a,sectionID:t.roomID,rooms:t.rooms,onClick:s,activeRoom:n}),!a&&t.subsections.map(r=>e.jsx(H,{section:r,onRoomClick:s,activeRoom:n},r.roomID))]},t.roomID)},Zt=({sections:t,rooms:s})=>{const[n,a]=l.useState(void 0);return e.jsxs("div",{className:"flex flex-col gap-1 flex-1 p-2 min-w-[33ch] h-full overflow-y-auto overflow-x-hidden",children:[t.map(o=>e.jsx(H,{section:o,onRoomClick:r=>{a(r)},activeRoom:n},o.roomID)),e.jsx(H,{section:{sectionName:"Others",roomID:"other",subsections:[],rooms:s},onRoomClick:o=>{a(o)},activeRoom:n})]})};function Jt(){const t=[{sectionName:"Test Section",rooms:[{roomID:"2",displayname:"test1",dm:!1,online:!1},{roomID:"3",displayname:"test2",dm:!1,online:!1}],roomID:"12",subsections:[{sectionName:"Test Subsection",rooms:[{roomID:"1",displayname:"test",avatarUrl:"https://randomuser.me/api/portraits/men/62.jpg",dm:!0,online:!0}],roomID:"14",subsections:[]}]}],s=[{roomID:"1",displayname:"test1234144222222",avatarUrl:"https://randomuser.me/api/portraits/men/62.jpg",dm:!0,online:!0},{roomID:"2",displayname:"test1",dm:!1,online:!1},{roomID:"3",displayname:"test2",dm:!1,online:!1}];return e.jsxs("div",{className:"flex flex-row w-full gap-2 min-h-screen",children:[e.jsxs("div",{className:"flex flex-col bg-gradient-to-br from-slate-100 via-gray-200 to-orange-200 border-r-[1px] border-slate-300",children:[e.jsxs("div",{className:"flex flex-row gap-2 m-2 p-1  items-center border-b-2",children:[e.jsx(F,{displayname:"Test",avatarUrl:"https://randomuser.me/api/portraits/men/62.jpg",dm:!1,online:!1}),e.jsxs("div",{className:"flex flex-row justify-between items-center w-full",children:[e.jsx("span",{className:"text-base font-semibold",children:"Abcd"}),e.jsx(rt,{size:28,stroke:"unset",className:"stroke-slate-600 rounded-full hover:bg-slate-300 p-1 cursor-pointer"})]})]}),e.jsx(Zt,{sections:t,rooms:s})]}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("div",{className:"flex-1",children:"TODO: events and welcome page"}),e.jsx(Wt,{namespace:"Editor",onChange:()=>{},onError:n=>console.error(n)})]})]})}const Yt=({children:t})=>Rt(n=>n.auth.host)?t:e.jsx(Z,{to:"login"});it.init({locateFile:()=>lt}).then(()=>{console.log("Using WebAssembly Olm")}).catch(t=>(console.log("Failed to load Olm: trying legacy version",t),new Promise((s,n)=>{const a=document.createElement("script");a.src=ct,a.onload=s,a.onerror=n,document.body.appendChild(a)}).then(()=>window.Olm.init()).then(()=>{console.log("Using legacy Olm")}).catch(s=>{console.log("Both WebAssembly and asm.js Olm failed!",s)})));function es(){return e.jsx(dt,{children:e.jsxs(ut,{children:[e.jsx(G,{path:"/",element:e.jsx(Yt,{children:e.jsx(Jt,{})})}),e.jsx(G,{path:"/login",element:e.jsx(Tt,{})})]})})}const ts=document.getElementById("root"),ss=mt(ts);ss.render(e.jsx(gt.StrictMode,{children:e.jsx(ht,{store:B,children:e.jsx(ft,{loading:e.jsx("span",{children:"Loading..."}),persistor:kt,children:e.jsx(es,{})})})}));
